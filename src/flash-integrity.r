erf <- function(x) 2 * pnorm(x * sqrt(2)) - 1

flashwear <- function(size, writecount, x, speed=6) {
  return(0.5*(1+erf(((x*(speed*1000*1000*1000/10)/(size*1000*1000*1000))-writecount)/sqrt(2*((writecount*0.1)**2)))))
}

xl <- c(0, 60000000)

svg('flash-integrity.svg', height=6, width=12)
plot(function(x) { return(flashwear(32, 100000, x)) }, col="green", xlab="", xaxt="n", ylab="", xlim=xl, ylim=c(0,1))
legend("topright", inset=.05, c("32 GB Drive", "64 GB Drive", "128 GB Drive", "256 GB Drive", "10% Threshold"), fill=c("green", "blue", "red", "purple", "black"))
axis(1,c(2628000,7884000,15770000,31540000,94610000,189200000), c("1 month", "3 months", "6 months", "1 year", "3 years", "6 years"))
title(main="Drive Wear After Continuous Writing to Flash Memory at 6Gb/s (w/ 8b/10b Coding)", sub="Average Lifespan of Flash Cell Approximated at 100k Writes", xlab="time elapsed", ylab="device wear")
par(new=TRUE)
plot(function(x) { return(flashwear(64, 100000, x)) }, col="blue", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
plot(function(x) { return(flashwear(128, 100000, x)) }, col="red", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
plot(function(x) { return(flashwear(256, 100000, x)) }, col="purple", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
abline(a=0.1, b=0, col="black", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
dev.off()

svg('flash-integrity-100000.svg', height=6, width=12)
plot(function(x) { return(flashwear(32, 100000, x)) }, col="green", xlab="", xaxt="n", ylab="", xlim=xl, ylim=c(0,1))
legend("topright", inset=.05, c("32 GB Drive", "64 GB Drive", "128 GB Drive", "256 GB Drive", "10% Threshold"), fill=c("green", "blue", "red", "purple", "black"))
axis(1,c(2628000,7884000,15770000,31540000,94610000,189200000), c("1 month", "3 months", "6 months", "1 year", "3 years", "6 years"))
title(main="Drive Wear After Continuous Writing to Flash Memory at 6Gb/s (w/ 8b/10b Coding)", sub="Average Lifespan of Flash Cell Approximated at 100k Writes", xlab="time elapsed", ylab="device wear")
par(new=TRUE)
plot(function(x) { return(flashwear(64, 100000, x)) }, col="blue", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
plot(function(x) { return(flashwear(128, 100000, x)) }, col="red", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
plot(function(x) { return(flashwear(256, 100000, x)) }, col="purple", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
abline(a=0.1, b=0, col="black", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
dev.off()

xl <- c(0, 640000000)

svg('flash-integrity-1000000.svg', height=6, width=12)
plot(function(x) { return(flashwear(32, 1000000, x)) }, col="green", xlab="", xaxt="n", ylab="", xlim=xl, ylim=c(0,1))
legend("topright", inset=.05, c("32 GB Drive", "64 GB Drive", "128 GB Drive", "256 GB Drive", "10% Threshold"), fill=c("green", "blue", "red", "purple", "black"))
axis(1,c(2628000,7884000,15770000,31540000,94610000,189200000,378400000,756900000), c("1 month", "3 months", "6 months", "1 year", "3 years", "6 years", "12 years", "24 years"))
title(main="Drive Wear After Continuous Writing to Flash Memory at 6Gb/s (w/ 8b/10b Coding)", sub="Average Lifespan of Flash Cell Approximated at 1M Writes", xlab="time elapsed", ylab="device wear")
par(new=TRUE)
plot(function(x) { return(flashwear(64, 1000000, x)) }, col="blue", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
plot(function(x) { return(flashwear(128, 1000000, x)) }, col="red", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
plot(function(x) { return(flashwear(256, 1000000, x)) }, col="purple", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
par(new=TRUE)
abline(a=0.1, b=0, col="black", xlab="", xaxt="n", ylab="", yaxt="n", xlim=xl, ylim=c(0,1))
dev.off()
